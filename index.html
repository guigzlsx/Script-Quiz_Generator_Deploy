<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de Script et Quiz</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="image/thunder-only-square.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Proxima+Nova:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
</head>
<body>
    <header class="banner">
        <a href="index.html" class="logo">
            <h1><img src="image/logotopcoach.png" alt="TopCoach"></h1>
        </a>
        <div class="burger-menu">
            <div class="burger-icon">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <nav class="menu-items">
                <!-- dark mode button removed -->
                <label class="checkbox-container">
                    <input type="checkbox" id="englishOption">
                    Generate in English <img src="image/gb-flag.png" alt="UK flag" style="height:1.2em;vertical-align:middle; margin-left:2px;">
                </label>
                <button class="btn btn-ghost btn-1" onclick="window.location.href='product_desc.html'">Description Produit</button>
                <button class="btn btn-ghost btn-1" onclick="window.location.href='product_smartphone.html'">Extraction Smartphone</button>
                <button class="btn btn-ghost btn-1" onclick="window.location.href='pdf_tools.html'">PDF Tools</button>
                <button id="clearScriptButton" class="clear-btn btn btn-sm">Effacer le script</button>
                
            </nav>
        </div>
    </header>

    <section class="page-description">
        <p>
          <strong>Bienvenue sur le G√©n√©rateur de Script & Quiz TopCoach !</strong><br>
          Importez un fichier <b>.txt</b>, <b>.pdf</b> ou <b>.docx</b> contenant la description de votre produit.<br>
          Taille maximale du fichier : <b>10 Mo</b>.<br>
          <b>Limite IA :</b> ~8‚ÄØ000 tokens (prompt + r√©ponse). Les contenus tr√®s longs sont automatiquement raccourcis.
          Cliquez sur <b>G√©n√©rer</b> pour obtenir automatiquement un script promotionnel et un quiz interactif adapt√©s √† votre contenu.
        </p>
    </section>

    <main class="pdf-tools-container">
        <div class="card">
            <header class="card-header">
                <div>
                    <h3>G√©n√©rer un script & quiz</h3>
                    <p class="muted">Importez votre contenu et cliquez sur G√©n√©rer</p>
                </div>
                <div class="card-actions">
                    <!-- actions (dark mode in header) -->
                </div>
            </header>
            <div class="card-body">
                <div class="file-upload-container drop-area">
                    <input type="file" id="fileInput" accept=".txt, .pdf, .docx"> 
                    <label for="fileInput" class="custom-file-upload" role="button" tabindex="0" aria-label="Choisir un fichier">Choisir un fichier üìÅ</label>
                </div>

                <div style="margin-top:12px; text-align:center; max-width:800px; margin-left:auto; margin-right:auto;">
                    <label for="extraInfo" style="display:block; margin-bottom:8px; color:var(--muted);">Informations compl√©mentaires (facultatif) :</label>
                    <textarea id="extraInfo" rows="4" placeholder="Ajouter des pr√©cisions qui pourront compl√©ter le document (ex : points √† insister, public cible)..."
                    style="width:100%; max-width:780px; padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit;"></textarea>
                </div>

                <button class="btn btn-primary btn-9" id="uploadButton">
                    <svg height="24" width="24" fill="#FFFFFF" viewBox="0 0 24 24" class="sparkle">
                        <path d="M10,21.236,6.755,14.745.264,11.5,6.755,8.255,10,1.764l3.245,6.491L19.736,11.5l-6.491,3.245ZM18,21l1.5,3L21,21l3-1.5L21,18l-1.5-3L18,18l-3,1.5ZM19.333,4.667,20.5,7l1.167-2.333L24,3.5,21.667,2.333,20.5,0,19.333,2.333,17,3.5Z"></path>
                    </svg>
                    <span class="text">G√©n√©rer</span>
                </button>
            </div>
        </div>
    </main>

    <div id="loader" class="loader" style="display: none;">
        <div class="progress"><div id="progressBar" class="progress-bar"></div></div>
        <div id="Chargement">Votre script et votre quiz chargent</div>
    </div>

    <div id="result" class="result" style="display: none;">
        <h2>Script et Quiz g√©n√©r√© :</h2>
        <pre id="scriptOutput"></pre>
        <div id="quizOutput"></div>
        <div class="export-buttons">
            <button id="exportQuizExcel" class="btn btn-ghost btn-1">Exporter le quiz en Excel</button>
            <button id="exportScriptDocx" class="btn btn-ghost btn-1">Exporter le script en DOCX</button>
        </div>
        <section class="page-description">
            <p>Apr√®s la g√©n√©ration, vous pouvez directement exporter le script en fichier Word (DOCX) ou le quiz en fichier Excel (XLSX). Cliquez sur le bouton d'export souhait√© pour obtenir votre fichier pr√™t √† l'emploi.</p>
        </section>
    </div>

    <button id="clearAllButton" class="clear-btn btn btn-sm" style="margin: 20px auto; display:none;">Supprimer tout</button>

    <script type="module" src="script.js" defer></script>
</body>
</html>
